<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Social Handle Checker</title>
  <style>
    :root {
      --bg: #f6f8fb;
      --card: #fff;
      --accent: #176be0;
      --muted: #666;
      --success: #0b8a3e;
      --danger: #d23f3f;
      --maxwidth: 1100px;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      margin: 0;
      background: var(--bg);
      color: #222;
      font-family: Inter, "Segoe UI", Roboto, Arial, sans-serif;
      -webkit-font-smoothing: antialiased;
    }

    .topbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 14px 20px;
      background: linear-gradient(90deg, #ffffff, #f1f6ff);
      border-bottom: 1px solid #e6eefc;
    }

    .topbar .brand {
      font-weight: 800;
      color: var(--accent);
      font-size: 18px;
    }

    .topbar .tag {
      color: var(--muted);
      font-size: 13px;
    }

    .container {
      max-width: var(--maxwidth);
      margin: 22px auto;
      display: flex;
      gap: 20px;
      padding: 0 14px;
    }

    .panel {
      flex: 1 1 auto;
    }

    h1 {
      margin: 2px 0 4px;
      font-size: 22px;
    }

    .desc {
      color: var(--muted);
      margin-top: 0;
      margin-bottom: 16px;
    }

    .card {
      background: var(--card);
      padding: 16px;
      border-radius: 10px;
      border: 1px solid #eef5ff;
      box-shadow: 0 8px 30px rgba(20, 40, 90, 0.03);
    }

    label {
      display: block;
      font-weight: 600;
      margin-bottom: 6px;
      color: #333;
    }

    select,
    input[type="file"],
    textarea {
      width: 100%;
      padding: 8px 10px;
      border: 1px solid #dfe9ff;
      border-radius: 6px;
      font-family: inherit;
      margin-bottom: 12px;
    }

    textarea {
      resize: vertical;
      font-size: 14px;
    }

    .file-controls .hint {
      color: var(--muted);
      margin-top: 6px;
      margin-bottom: 4px;
      font-size: 13px;
    }

    .format-preview {
      margin-top: 10px;
      background: #0f1724;
      color: #e6f0ff;
      padding: 12px;
      border-radius: 6px;
      font-size: 13px;
      overflow-x: auto;
      font-family: monospace;
      white-space: pre;
    }

    .radio-group {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      margin-bottom: 16px;
    }

    .platform-item {
      display: flex;
      gap: 6px;
      align-items: center;
      cursor: pointer;
      padding: 4px 10px 4px 6px;
      border-radius: 6px;
      transition: background 0.15s ease;
    }

    .platform-item:hover {
      background: rgba(23, 107, 224, 0.08);
    }

    .platform-item input {
      cursor: pointer;
    }

    .actions {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 10px;
    }

    .btn {
      padding: 9px 14px;
      border-radius: 8px;
      border: 1px solid #dfe9ff;
      background: #fff;
      cursor: pointer;
      font-family: inherit;
      font-size: 14px;
      font-weight: 600;
    }

    .btn.primary {
      background: var(--accent);
      color: #fff;
      border: none;
      box-shadow: 0 6px 18px rgba(23, 107, 224, 0.12);
    }

    .btn:disabled {
      opacity: 0.7;
      cursor: not-allowed;
      filter: grayscale(.1);
    }

    .btn.loading {
      opacity: 0.6;
      pointer-events: none;
    }

    .loader {
      display: none;
      width: 24px;
      height: 24px;
      border: 3px solid #e3e3e3;
      border-top: 3px solid var(--accent);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    .table-wrap {
      overflow: auto;
      max-height: 540px;
    }

    table {
      border-collapse: collapse;
      width: 100%;
      min-width: 600px;
      margin-top: 6px;
    }

    th,
    td {
      padding: 10px 12px;
      border-bottom: 1px solid #eef4ff;
      text-align: center;
      font-size: 14px;
    }

    th {
      background: #f8fbff;
      font-weight: 700;
      color: #222;
      position: sticky;
      top: 0;
    }

    .status-true {
      color: var(--success);
      font-weight: 700;
    }

    .status-false {
      color: var(--danger);
      font-weight: 700;
    }

    .footer {
      text-align: center;
      color: var(--muted);
      padding: 20px;
      font-size: 13px;
      margin-top: 18px;
    }

    /* responsive */
    @media (max-width:980px) {
      .container {
        flex-direction: column;
        padding: 0 12px;
      }
    }
  </style>
</head>

<body>

  <div class="topbar">
    <div class="brand">Handle Checker</div>
    <div class="tag">Check username availability across platforms</div>
  </div>

  <div class="container">
    <div class="panel">
      <h1>Social Handle Availability Checker</h1>
      <p class="desc">Check if usernames are available on Instagram, YouTube, X, and LinkedIn</p>

      <div class="card">
        <label>Input Type</label>
        <select id="inputType">
          <option value="">Select Input Method</option>
          <option value="txt">TXT File</option>
          <option value="csv">CSV File</option>
          <option value="excel">Excel (.xlsx)</option>
          <option value="panel">Manual Entry</option>
        </select>

        <div id="fileBox" style="display:none;">
          <label>Upload File</label>
          <input type="file" id="fileInput" accept=".txt,.csv,.xlsx">
          <div class="file-controls">
            <p class="hint">Format preview:</p>
            <div id="preview" class="format-preview"></div>
          </div>
        </div>

        <div id="panelBox" style="display:none;">
          <label>Enter Names (one per line)</label>
          <textarea id="textInput" rows="6" placeholder="codexly&#10;logiqo&#10;thinkbit"></textarea>
        </div>

        <label style="margin-top:16px">Select Platforms</label>
        <div class="radio-group">
          <label class="platform-item">
            <input type="checkbox" value="instagram" checked>
            <span>Instagram</span>
          </label>
          <label class="platform-item">
            <input type="checkbox" value="youtube" checked>
            <span>YouTube</span>
          </label>
          <label class="platform-item">
            <input type="checkbox" value="x" checked>
            <span>X</span>
          </label>
          <label class="platform-item">
            <input type="checkbox" value="linkedin" checked>
            <span>LinkedIn</span>
          </label>
        </div>

        <div class="actions">
          <button id="submitBtn" class="btn primary">Check Availability</button>
          <div class="loader" id="loader"></div>
        </div>
      </div>

      <div class="card" id="resultSection" style="display:none; margin-top:20px;">
        <h2 style="margin-top:0">Results</h2>
        <div class="table-wrap">
          <div id="resultTable"></div>
        </div>
      </div>

    </div>
  </div>

  <div class="footer">
    Social Handle Checker &copy; 2026
  </div>

  <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>

  <script>
    const inputType = document.getElementById("inputType");
    const fileBox = document.getElementById("fileBox");
    const panelBox = document.getElementById("panelBox");
    const fileInput = document.getElementById("fileInput");
    const textInput = document.getElementById("textInput");
    const submitBtn = document.getElementById("submitBtn");
    const loader = document.getElementById("loader");
    const preview = document.getElementById("preview");
    const resultSection = document.getElementById("resultSection");
    const resultTable = document.getElementById("resultTable");

    let running = false;

    inputType.addEventListener("change", () => {

      fileBox.style.display =
        ["txt", "csv", "excel"].includes(inputType.value) ? "block" : "none";

      panelBox.style.display =
        inputType.value === "panel" ? "block" : "none";

      // TXT preview
      if (inputType.value === "txt") {
        preview.textContent =
          `Codexly
Logiqo
Thinkbit
Codezeno`;
      }

      // CSV preview
      else if (inputType.value === "csv") {
        preview.textContent =
          `name
Codexly
Logiqo
Thinkbit
Codezeno`;
      }

      // Excel preview
      else if (inputType.value === "excel") {
        preview.innerHTML = `
<table style="width:100%;border-collapse:collapse">
<tr><th style="border:1px solid #555;padding:4px">Name</th></tr>
<tr><td style="border:1px solid #555;padding:4px">Codexly</td></tr>
<tr><td style="border:1px solid #555;padding:4px">Logiqo</td></tr>
<tr><td style="border:1px solid #555;padding:4px">Thinkbit</td></tr>
<tr><td style="border:1px solid #555;padding:4px">Codezeno</td></tr>
</table>`;
      }

      else {
        preview.innerHTML = "";
      }
    });

    submitBtn.addEventListener("click", checkHandles);

    async function checkHandles() {
      if (running) return;
      running = true;

      submitBtn.disabled = true;
      submitBtn.classList.add('loading');
      loader.style.display = "block";

      try {
        const names = await collectNames();
        if (!names.length) {
          reset("No names found");
          return;
        }

        const platforms = [...document.querySelectorAll(".platform-item input:checked")]
          .map(p => p.value);

        if (!platforms.length) {
          reset("Select at least one platform");
          return;
        }

        const res = await fetch("/api/check", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ names })
        });

        if (!res.ok) {
          throw new Error(`Server error: ${res.status}`);
        }

        const data = await res.json();

        buildTable(data.results, platforms);

        resultSection.style.display = "block";
        resultSection.scrollIntoView({ behavior: "smooth" });

      } catch (err) {
        alert("Error: " + err.message);
      }

      reset();
    }

    async function collectNames() {

      if (inputType.value === "panel") {
        return textInput.value.split(/\r?\n/).filter(n => n.trim());
      }

      const file = fileInput.files[0];
      if (!file) throw new Error("Please upload a file");

      if (inputType.value === "txt") {
        const txt = await file.text();
        return txt.split(/\r?\n/).filter(n => n.trim());
      }

      if (inputType.value === "csv") {
        const txt = await file.text();
        const lines = txt.split(/\r?\n/).filter(n => n.trim());
        // Skip header if first line looks like a header
        const start = lines[0] && lines[0].toLowerCase().includes('name') ? 1 : 0;
        return lines.slice(start).map(r => r.split(",")[0]).filter(n => n.trim());
      }

      if (inputType.value === "excel") {
        const buffer = await file.arrayBuffer();
        const workbook = XLSX.read(buffer, { type: "array" });
        const sheet = workbook.Sheets[workbook.SheetNames[0]];
        const json = XLSX.utils.sheet_to_json(sheet, { header: 1 });
        // Skip header row (first row)
        return json.slice(1).map(row => row[0]).filter(n => n);
      }

      return [];
    }

    function reset(msg) {
      if (msg) alert(msg);
      loader.style.display = "none";
      submitBtn.disabled = false;
      submitBtn.classList.remove('loading');
      running = false;
    }

    function buildTable(data, platforms) {

      let html = "<table><tr><th>Name</th>";

      platforms.forEach(p => {
        const displayName = p.charAt(0).toUpperCase() + p.slice(1);
        html += `<th>${displayName}</th>`;
      });

      html += "</tr>";

      data.forEach(row => {
        html += `<tr><td>${row.name}</td>`;
        platforms.forEach(p => {
          const available = row[p];
          html += `<td class="status-${available ? "true" : "false"}">${available ? "✓ Available" : "✗ Taken"}</td>`;
        });
        html += "</tr>";
      });

      html += "</table>";

      resultTable.innerHTML = html;
    }
  </script>

</body>

</html>